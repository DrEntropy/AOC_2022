```{r}
library(tidyverse)
library(rlang)
```
 

## Import and process data
 

```{r}
raw_data <-  read_lines('data/day7_input.txt')
```

Each line has three possible types:
$ -> A command
<numbers> -> A file size
dir <identifier> -> A subdirectory in a listing

The commands are 
cd /
cd <identifier>
cd ..
ls


```{r}
# Directories are environments (so can be modified) of name, sub_dirs, contents.  
directory <- env(empty_env(), name = 'root', sub_dirs = NULL,  contents = NULL)
curr_dir <- directory

process_cd  <- \(cd, new_dir){
  new_dir <- trimws(new_dir)
  if(new_dir == '/'){
    return(directory)
  } else if(new_dir == '..'){
    return(env_parent(cur_dir)) # will cause error if cd on root
  } else {
    # As far as i can tell this is never called before ls reveals name
    
  }
}

process_ls <- \(cd, dir) {
  # somehow walk down into the structure and modify it. This seems really painful in R without references.
}

```


```{r}


for(line in raw_data){
  if(substr(line,1,4)=='$ cd') {
    curr_dir <- process_cd(curr_dir, substr(line,6,nchar(line)))
  } else if(substr(line,1,2)=='$ ls') {
    curr_dir <- process_ls(curr_dir)
  } else {
    print("parse error!")
    break
  }
    
}
```

